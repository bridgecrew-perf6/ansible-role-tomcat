--- 
- name: Create BASEDIR
  file:
    path: "{{ BASEDIR }}"
    state: directory
    owner: "{{ TOMCAT_USER }}"
    group: "{{ TOMCAT_GROUP }}"

- name: "Extract Files {{ CATALINA_BASEDIR }}/lib"  
  unarchive: 
    src: "{{ TOMCAT_DWNLDURL }}"
    remote_src: True
    dest: /opt/tomcat
    exclude:
      - "*.bat"
      - "*.gz"
    extra_opts:
    - "{{ CATALINA_BASEDIR }}/{{ item.dir }}"
  with_items:
    - dir: lib
    - dir: bin

- name: Recursively change ownership of {{ TOMCAT_VERSION }}
  file:
    path: "{{ CATALINA_HOME }}"
    state: directory
    recurse: yes
    owner: "{{ TOMCAT_USER }}"
    group: "{{ TOMCAT_GROUP }}"
